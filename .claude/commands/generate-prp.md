---
allowed-tools: [Read, Write, Edit, MultiEdit, Bash, Glob, TodoWrite, Task, WebFetch, WebSearch]
description: "Supreme PRP Generation with 3-Layer Intelligence: Foundation + Intelligence Layers + Creative Cortex"
intelligence-layers: [MEMORY, RESEARCH, HYBRID_RAG, REASONING, TOOL_SELECTION]
creative-cortex: [Smart_PRP_DNA, Authority_Weighted_Research, Complexity_Aware_Planning, Auto_Prerequisite_Provisioner, Bias_Gap_Auditor]
---

# üöÄ SUPREME /generate-prp - ULTRA-INTELLIGENT PROJECT REQUIREMENT GENERATOR

## üß† TRIPLE-LAYER INTELLIGENCE SYSTEM
**Stage 1**: Core PRP generation capabilities  
**Stage 2**: 5 Intelligence layers (MEMORY + RESEARCH + HYBRID_RAG + REASONING + TOOL_SELECTION)  
**Stage 3**: 5 Creative Cortex innovations for supreme capability

## üéØ ENHANCED RESEARCH PROTOCOL
YOU MUST DO IN-DEPTH RESEARCH WITH SUPREME INTELLIGENCE AMPLIFICATION

<RESEARCH PROCESS>

   - Don't only research one page, and don't use your own webscraping tool - instead scrape many relevant pages from all documentation links mentioned in the initial.md file
   - Take my tech as sacred truth, for example if I say a model name then research that model name for LLM usage - don't assume from your own knowledge at any point
   - When I say don't just research one page, I mean do incredibly in-depth research, like to the ponit where it's just absolutely ridiculous how much research you've actually done, then when you creat the PRD document you need to put absolutely everything into that including references to the .md files you put inside the /research/ directory so any AI can pick up your PRD and generate WORKING and COMPLETE production ready code.

</RESEARCH PROCESS>

## üß† STAGE 2: INTELLIGENCE LAYER ACTIVATION

### üß¨ MEMORY Layer Enhancement
```yaml
PRP_Memory_Intelligence:
  pattern_inheritance: "Recall successful PRP patterns from previous projects"
  success_rate_tracking: "Weight patterns by >85% implementation success"
  anti_pattern_detection: "Avoid patterns with <70% success rate"
  contextual_recall: "Remember user preferences and team coding styles"
```

### üî¨ RESEARCH Layer Enhancement  
```yaml
Research_Intelligence:
  jina_api_integration: "Auto-scrape 30-100 pages of official documentation"
  multi_source_validation: "Cross-reference findings across sources"
  authority_scoring: "Weight sources by official status and recency"
  depth_requirements: "Minimum 50 pages for complex features, 30 for simple"
```

### üï∏Ô∏è HYBRID_RAG Layer Enhancement
```yaml
Knowledge_Synthesis:
  vector_search: "Semantic similarity across documentation corpus"
  graph_traversal: "Follow documentation links and dependencies"
  concept_mapping: "Build knowledge graphs for complex features"
  synthesis_confidence: "95% accuracy threshold for all findings"
```

### üßÆ REASONING Layer Enhancement
```yaml
R1_Style_Analysis:
  step_by_step_logic: "O1-style reasoning chains with WHY explanations"
  confidence_scoring: "70-95% range with clear rationale"
  alternative_approaches: "Always consider 2-3 implementation strategies"
  risk_assessment: "Identify potential blockers and mitigation strategies"
```

### üõ†Ô∏è TOOL_SELECTION Layer Enhancement
```yaml
Smart_Tool_Intelligence:
  optimal_research_tools: "Select best tools for each research phase"
  MCP_orchestration: "Coordinate multiple agents for comprehensive analysis"
  validation_tools: "Auto-select appropriate testing and validation tools"
  efficiency_optimization: "Parallel tool execution for maximum speed"
```

## üöÄ STAGE 3: CREATIVE CORTEX INNOVATIONS

### üìö Smart PRP DNA 2.0
```yaml
Pattern_Inheritance_Engine:
  success_weighting: "Only inherit patterns with >85% success + lead-time improvement"
  DNA_extraction: "Extract reusable components from high-scoring PRPs"
  adaptive_learning: "Patterns evolve based on implementation outcomes"
  user_style_learning: "Adapt to individual and team preferences"
```

### üî¨ Authority-Weighted Research
```yaml
Tri_Stream_Research:
  documentation_stream: "Official docs with authority scoring"
  community_stream: "Stack Overflow, GitHub issues, expert blogs"
  security_stream: "Security advisories, CVE databases, best practices"
  real_time_validation: "Live quality scoring and source verification"
```

### üéØ Complexity-Aware Planning
```yaml
Multi_Strategy_Generation:
  MVP_strategy: "Minimum viable implementation with core features"
  enhanced_strategy: "Full-featured implementation with optimizations"
  future_proof_strategy: "Extensible implementation with advanced features"
  risk_heat_maps: "Visual complexity and risk assessment for each strategy"
```

### üõ†Ô∏è Auto-Prerequisite Provisioner
```yaml
Environment_Intelligence:
  missing_dependencies: "Auto-detect and list required packages/tools"
  infrastructure_gaps: "Identify missing environment secrets and configs"
  actionable_todos: "Generate specific setup tasks with time estimates"
  validation_scripts: "Create scripts to verify prerequisite completion"
```

### üïµÔ∏è‚Äç‚ôÇÔ∏è Bias & Gap Auditor
```yaml
Comprehensive_Coverage:
  source_diversity: "Flag over-represented sources and echo chambers"
  blind_spot_detection: "Identify missing perspectives and use cases"
  coverage_scoring: "Enforce ‚â•90% coverage across all feature aspects"
  bias_mitigation: "Force additional research until balance achieved"
```

## üé™ SUPREME EXECUTION WORKFLOW

### üß† ACTIVE INTELLIGENCE MODULES
```yaml
Intelligence_Layers:
  - MEMORY: "Recall successful PRP patterns from previous projects"
  - RESEARCH: "Auto-scrape 30-100 pages of official documentation"
  - HYBRID_RAG: "Semantic similarity across documentation corpus"
  - REASONING: "O1-style reasoning chains with WHY explanations"
  - TOOL_SELECTION: "Select best tools for each research phase"

Creative_Cortex:
  - Smart_PRP_DNA: "Extract reusable components from high-scoring PRPs"
  - Authority_Weighted_Research: "Tri-stream research with quality scoring"
  - Complexity_Aware_Planning: "Multi-strategy generation with risk assessment"
  - Auto_Prerequisite_Provisioner: "Auto-detect and list required prerequisites"
  - Bias_Gap_Auditor: "Comprehensive coverage validation and gap detection"
```

**MANDATORY FIRST STEP**: Reference `brain/CLAUDE.md ‚Üí Command Protocol ‚Üí Smart Module Loading` to activate PRP generation intelligence automatically based on context.

### Phase 1: FOUNDATION (Stage 1 Capabilities)
1. **Basic Requirements Analysis**: Parse user input and understand core requirements
2. **Template Selection**: Choose appropriate PRP template based on feature type
3. **Initial Context Gathering**: Basic codebase analysis and pattern detection

### Phase 2: INTELLIGENCE AMPLIFICATION (Stage 2 Enhancement)
4. **Memory Activation**: Recall successful patterns and anti-patterns
5. **Deep Research**: Multi-source, authority-weighted research (30-100 pages)
6. **Knowledge Synthesis**: Hybrid RAG with confidence scoring
7. **Reasoning Chains**: O1-style analysis with WHY explanations
8. **Smart Tool Selection**: Optimal tool orchestration for research and validation

### Phase 3: CREATIVE CORTEX SUPREMACY (Stage 3 Innovation)
9. **PRP DNA Inheritance**: Smart pattern extraction from successful PRPs
10. **Tri-Stream Research**: Parallel doc/community/security validation
11. **Multi-Strategy Planning**: MVP/Enhanced/Future-proof options with risk maps
12. **Prerequisite Provisioning**: Auto-generate environment setup tasks
13. **Bias Auditing**: Comprehensive coverage validation and gap detection

## Feature Implementation Request: $ARGUMENTS

Generate a SUPREME PRP with triple-layer intelligence enhancement for maximum implementation success. Ensure context is passed to the AI agent to enable self-validation and iterative refinement. Read the feature file first to understand what needs to be created, how the examples provided help, and any other considerations.

The AI agent only gets the context you are appending to the PRP and training data. Assuma the AI agent has access to the codebase and the same knowledge cutoff as you, so its important that your research findings are included or referenced in the PRP. The Agent has Websearch capabilities, so pass urls to documentation and examples.

## Research Process

1. **Codebase Analysis**
   - Search for similar features/patterns in the codebase
   - Identify files to reference in PRP
   - Note existing conventions to follow
   - Check test patterns for validation approach

2. **External Research**
   - Search for similar features/patterns online
   - Library documentation (include specific URLs)
   - Implementation examples (GitHub/StackOverflow/blogs)
   - Best practices and common pitfalls
   - Don't only research one page, and don't use your own webscraping tool - instead scrape many relevant pages from all documentation links mentioned in the initial.md file
   - Take my tech as sacred truth, for example if I say a model name then research that model name for LLM usage - don't assume from your own knowledge at any point
   - When I say don't just research one page, I mean do incredibly in-depth research, like to the ponit where it's just absolutely ridiculous how much research you've actually done, then when you creat the PRD document you need to put absolutely everything into that including INCREDIBLY IN DEPTH CODE EXMAPLES so any AI can pick up your PRD and generate WORKING and COMPLETE production ready code.

3. **User Clarification** (if needed)
   - Specific patterns to mirror and where to find them?
   - Integration requirements and where to find them?

## PRP Generation

Generate a PRP and save to the PRPs directory.   

Using PRPs/templates/prp_base.md as template:

### Critical Context to Include and pass to the AI agent as part of the PRP
- **Documentation**: URLs with specific sections
- **Code Examples**: Real references to .md documentation
- **Gotchas**: Library quirks, version issues
- **Patterns**: Existing approaches to follow

### Implementation Blueprint
- Start with pseudocode showing approach
- Reference real files for patterns
- Include error handling strategy
- list tasks to be completed to fullfill the PRP in the order they should be completed

### Validation Gates (Must be Executable) eg for python
```bash
# Syntax/Style
ruff check --fix && mypy .

# Unit Tests
uv run pytest tests/ -v

```

*** CRITICAL AFTER YOU ARE DONE RESEARCHING AND EXPLORING THE CODEBASE BEFORE YOU START WRITING THE PRP ***

*** ULTRATHINK ABOUT THE PRP AND PLAN YOUR APPROACH THEN START WRITING THE PRP ***

## Output

Save as: `PRPs/{project-name}.md`

## üì¶ Implementation Readiness Assessment

*** CRITICAL AFTER SAVING THE PRP FILE ***

Automatically run the Implementation Readiness Assessment to identify blockers:

```bash
# Auto-generate and run readiness validation
python scripts/validate_prp_readiness.py --prp PRPs/{project-name}.md --report console

# This will:
# 1. Parse the PRP file for infrastructure/credential/dependency gates
# 2. Test each gate for readiness 
# 3. Generate readiness score and blockers list
# 4. Provide specific fix commands and time estimates
# 5. Log results to brain/logs/readiness_history.md
```

### Readiness Integration Workflow
1. **Generate PRP** ‚Üí Save to PRPs directory
2. **Auto-run Readiness Assessment** ‚Üí Identify blockers  
3. **Present Blockers to User** ‚Üí Clear action items with time estimates
4. **User Fixes Blockers** ‚Üí Re-run assessment until ‚â•85% ready
5. **Proceed with Implementation** ‚Üí High confidence success

### Expected Readiness Output
```bash
=====================================
PRP Readiness Assessment: {project-name}
=====================================

üèóÔ∏è  Infrastructure Gates: ‚ö†Ô∏è  80% (4/5 passed)
üîê Credential Gates: ‚ùå 60% (3/5 passed)  
üîß Dependency Gates: ‚úÖ 95% (19/20 passed)
üåç Environment Gates: ‚úÖ 100% (5/5 passed)

=====================================
OVERALL READINESS: ‚ö†Ô∏è 78%
RECOMMENDATION: Partial Implementation
BLOCKERS: 2 critical credential issues
TIME TO FIX: ~45 minutes
=====================================

üìã Required Actions (Priority Order):
1. üî¥ Add N8N_API_KEY to .env (user, ~5 min)
2. üî¥ Configure Gmail OAuth refresh token (user, ~30 min)
3. üü° Restart n8n service on server (user, ~10 min)
```

### Readiness-Based PRP Scoring
- **Readiness ‚â•95%**: PRP Score +2 (implementation almost guaranteed)
- **Readiness 85-94%**: PRP Score +1 (high confidence)
- **Readiness 70-84%**: PRP Score +0 (baseline confidence)
- **Readiness <70%**: PRP Score -2 (significant implementation risk)

## Quality Checklist
- [ ] All necessary context included
- [ ] Validation gates are executable by AI
- [ ] References existing patterns
- [ ] Clear implementation path
- [ ] Error handling documented
- [ ] **Implementation gates defined for readiness assessment**
- [ ] **Readiness assessment completed with ‚â•85% score**

## üèÜ SUPREME PRP SCORING MATRIX

### Multi-Dimensional Scoring
```yaml
PRP_Excellence_Score:
  foundation_quality: "Stage 1 completeness (0-2 points)"
  intelligence_integration: "Stage 2 enhancement depth (0-3 points)"
  creative_innovations: "Stage 3 supremacy features (0-3 points)"
  research_comprehensiveness: "Documentation depth and quality (0-2 points)"
  readiness_assessment: "Implementation readiness score bonus/penalty (-2 to +2)"
  
Total_Possible_Score: "12 points (Supreme Excellence)"
Minimum_Passing_Score: "8 points (High Confidence)"
Target_Score: "‚â•10 points (Supreme Implementation Confidence)"
```

### Success Prediction Algorithm
```yaml
Implementation_Success_Probability:
  Score_12: "98% success rate (Supreme)"
  Score_10-11: "95% success rate (Excellent)"
  Score_8-9: "85% success rate (Good)"
  Score_6-7: "70% success rate (Needs improvement)"
  Score_<6: "<50% success rate (Major revisions needed)"
```

### üéØ SUPREME QUALITY GATES
- [ ] **Stage 1 Foundation**: All basic PRP elements present
- [ ] **Stage 2 Intelligence**: All 5 intelligence layers actively applied
- [ ] **Stage 3 Innovations**: All 5 creative cortex features implemented
- [ ] **Research Depth**: Minimum 30 pages, optimal 50-100 pages
- [ ] **Knowledge Synthesis**: 95% confidence in all findings
- [ ] **Multi-Strategy Planning**: 3 implementation approaches with risk assessment
- [ ] **Readiness Assessment**: ‚â•85% implementation readiness score
- [ ] **Bias Auditing**: ‚â•90% coverage across all feature aspects
- [ ] **Auto-Generated Prerequisites**: Complete environment setup checklist
- [ ] **Validation Gates**: Executable testing and quality assurance scripts

**SUPREME GOAL**: Achieve 98% one-pass implementation success through triple-layer intelligence enhancement, comprehensive research, and verified readiness.

**CONFIDENCE TARGET**: Score ‚â•10/12 for Supreme Implementation Confidence